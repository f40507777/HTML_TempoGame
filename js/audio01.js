var audiogame={};
audiogame.dots = [];
audiogame.startingTime = 0;
audiogame.dotImage = new Image();
audiogame.totalDotsCount=0;
audiogame.totalSucessCount=0;
audiogame.successCount=5;
// an array to store all music notes data.
audiogame.musicNotes = [];//時間+","+哪一槓
//audiogame.leveldata = "1.592,3;1.984,2;2.466,1;2.949,2;4.022,3;4.443,2;4.594,1;5.498,3;5.92,2;6.04,1;7.034,2;7.395,3;7.968,2;8.45,1;8.962,2;10.018,3;10.258,2;10.44,2;10.711,1;10.977,2;11.556,3;12.008,1;13.588,3;14.013,2;14.495,1;14.946,2;16.003,3;16.395,2;16.546,1;17.48,3;17.85,2;18.001,1;19.026,2;19.508,3;19.96,2;20.412,1;20.955,2;22.01,3;22.252,2;22.432,2;22.673,1;23.518,3;23.788,2;24.029,1;25.024,3;25.506,2;26.019,1;26.531,2;27.043,3;28.038,3;28.52,2;28.972,1;29.454,2;29.967,3;30.51,2;31.022,3;31.474,2;31.956,3;32.408,2;32.89,3;33.433,2;34.006,3;34.398,2;34.518,1;35.453,3;35.875,2;36.026,1;37.111,2;37.504,3;38.016,1;38.529,3;38.981,2;39.524,3;40.007,2;40.459,1;40.971,2;41.483,3;41.936,2;42.448,1;42.992,2;43.444,3;43.956,2;44.378,3;44.92,2;45.945,3;46.337,2;46.488,1;47.513,3;47.875,2;47.995,1;49.141,2;49.533,3;50.045,2;50.557,1;51.039,2;51.521,3;52.004,2;52.486,1;52.998,2;53.481,3;53.993,2;54.505,1;54.988,2;55.44,3;55.952,2;56.434,3;56.916,2;57.429,1;57.911,2;58.454,3;58.966,2;59.539,3;60.051,2;61.256,3;61.739,2;62.222,1;62.704,2;63.216,3;63.699,2;64.212,1;64.755,2;65.267,3;65.749,2;66.261,3;66.743,2;67.256,3;67.738,2;68.251,1;68.764,2;69.247,3;69.729,2;70.271,3;70.753,2;71.265,1;71.717,2;72.289,3;73.223,3;73.736,2;74.249,1;74.731,2;75.274,3;75.756,2;76.268,3;76.78,2;77.262,3;77.744,2;78.257,3;78.77,2;79.252,1;79.765,2;80.277,3;80.729,2;81.241,1;81.754,2;82.266,3;82.779,3;83.261,2;83.744,1;84.256,2;84.799,3;85.643,3;86.276,2;86.758,3;87.24,2;87.722,3;88.236,2;88.778,1;89.26,2;89.773,3;90.256,2;90.708,1;91.191,2;91.763,3;92.216,2;92.729,3;93.241,2;93.753,1;94.235,3;94.748,3;95.29,2;95.742,3;96.224,2;96.827,3;97.671,3;98.334,3;98.906,3;100.022,3;100.444,2;100.564,1;101.468,3;101.859,2;102.01,1;102.975,2;103.367,3;103.518,2;103.88,3;104.031,2;104.393,3;104.544,2;104.905,3;105.057,2;105.961,3;106.205,2;106.416,2;106.657,1;106.928,2;107.169,3;107.441,2;107.712,1;107.984,3;108.527,2;109.009,1;109.401,2;109.521,3;110.034,2;110.546,3;111.029,2;111.964,3;112.084,2;112.265,1;112.416,2;112.988,3;113.501,3;113.892,2;114.043,1;114.525,2;115.037,3;115.399,2;115.55,1;115.852,3;116.002,2;116.365,3;116.485,2;116.847,3;116.998,2;117.963,3;118.354,2;118.506,1;119.503,3;119.865,2;120.015,1;";
audiogame.leveldata="";
audiogame.leveldata1 ="4.019,1,0;5.035,2,0;6.258,3,0;7.746,4,0;9.031,5,0;10.298,6,0;11.693,5,0;13.035,4,0;14.232,1,0;14.265,2,0;15.509,3,0;16.822,5,0;16.849,6,0;18.283,4,0;19.540,1,0;19.567,2,0;20.863,3,0;22.248,5,0;22.273,6,0;23.545,4,0;24.938,1,0;26.163,2,0;27.576,3,0;28.737,4,0;30.130,5,0;31.444,6,0;32.787,5,0;34.307,4,0;35.565,1,0;36.790,2,0;38.060,3,0;39.489,4,0;40.713,5,0;42.179,6,0;43.466,5,0;44.834,4,0;46.076,1,0;46.858,6,0;46.924,5,0;47.390,2,0;47.965,4,0;48.056,5,0;48.668,3,0;49.217,4,0;49.533,5,0;49.900,2,0;50.403,4,0;50.693,5,0;51.087,1,0;51.611,4,0;51.737,5,0;52.221,2,0;52.851,6,0;52.921,5,0;53.033,4,0;53.403,3,0;54.002,4,0;54.095,5,0;54.605,2,0;55.181,4,0;55.284,5,0;55.839,1,0;56.450,6,0;57.098,2,0;57.657,5,0;58.205,3,0;58.844,4,0;59.421,2,0;60.041,5,0;60.626,1,0;61.239,6,0;61.804,2,0;62.434,5,0;63.019,3,0;63.613,4,0;64.234,2,0;64.459,5,0;64.828,1,0;65.035,6,0;65.523,1,0;66.088,1,0;67.835,1,0;68.418,1,0;70.182,6,0;70.730,6,0;72.595,6,0;73.178,6,0;74.986,6,0;75.009,1,0;75.247,5,0;75.278,2,0;76.174,6,0;76.196,1,0;77.500,6,0;77.507,1,0;77.733,2,0;77.741,5,0;78.623,6,0;78.658,1,0;79.891,3,0;81.088,2,0;82.339,1,0;83.438,2,0;84.625,3,0;84.939,4,0;85.254,3,0;85.532,4,0;85.830,3,0;86.136,4,0;86.398,3,0;86.748,4,0;87.043,3,0;87.314,4,0;87.605,3,0;87.911,4,0;88.234,3,0;88.537,4,0;88.845,3,0;89.122,4,0;89.440,2,0;89.709,5,0;90.014,2,0;90.294,5,0;90.591,2,0;90.877,5,0;91.166,2,0;91.509,5,0;91.787,2,0;92.083,5,0;92.390,2,0;92.716,5,0;92.975,2,0;93.317,5,0;93.586,2,0;93.840,5,0;94.145,3,0;94.505,4,0;94.828,3,0;95.126,4,0;95.413,3,0;95.773,4,0;96.116,3,0;96.329,4,0;96.592,3,0;96.880,4,0;97.178,3,0;97.491,4,0;97.789,3,0;98.167,4,0;98.436,3,0;98.727,4,0;99.002,2,0;99.328,5,0;99.580,2,0;99.939,5,0;100.254,2,0;100.523,5,0;100.832,2,0;101.127,5,0;101.450,3,0;101.704,4,0;102.044,3,0;102.261,4,0;102.576,2,0;102.910,5,0;103.234,2,0;103.413,5,0;103.826,1,0;103.954,2,0;104.080,3,0;104.338,4,0;104.420,5,0;104.699,6,0;104.789,5,0;104.914,4,0;105.058,3,0;105.194,2,0;105.293,1,0;106.498,1,0;106.985,1,0;107.488,1,0;108.028,1,0;108.623,2,0;109.170,2,0;109.883,2,0;110.444,2,0;111.000,3,0;111.601,3,0;112.248,3,0;112.835,3,0;113.445,2,0;114.012,2,0;114.615,2,0;115.219,2,0;115.831,6,0;116.137,5,0;116.265,4,0;116.993,6,0;117.244,5,0;117.540,4,0;118.263,6,0;118.567,5,0;118.819,4,0;119.474,6,0;119.719,5,0;120.059,4,0;120.652,1,0;120.880,2,0;121.194,3,0;121.859,1,0;122.093,2,0;122.381,3,0;123.040,1,0;123.298,2,0;123.604,3,0;124.252,1,0;124.496,2,0;124.803,3,0;125.503,1,0;125.686,6,0;126.060,5,0;126.295,4,0;126.646,2,0;127.168,4,0;127.277,5,0;127.835,3,0;128.354,4,0;128.475,5,0;129.067,2,0;129.591,4,0;129.939,5,0;130.291,1,0;130.946,5,0;131.478,4,0;132.044,6,0;132.127,5,0;132.242,4,0;132.647,3,0;133.171,4,0;133.287,5,0;133.897,2,0;134.978,1,0;136.268,2,0;137.408,3,0;138.659,2,0;139.818,1,0;141.036,2,0;142.196,3,0;143.428,2,0;144.616,6,0;145.795,5,0;146.982,4,0;148.161,5,0;149.359,6,0;150.537,5,0;151.762,4,0;152.948,5,0;154.208,3,0;154.496,4,0;154.820,3,0;155.090,4,0;155.404,2,0;155.692,4,0;156.018,2,0;156.251,4,0;156.605,1,0;156.853,4,0;157.258,1,0;157.474,4,0;157.789,2,0;158.105,4,0;158.439,2,0;158.664,4,0;159.003,3,0;159.304,4,0;159.616,3,0;159.885,4,0;160.172,2,0;160.498,4,0;160.860,2,0;161.056,4,0;161.416,1,0;161.632,4,0;162.045,1,0;162.227,4,0;162.658,2,0;162.945,4,0;163.306,2,0;163.501,4,0;163.831,3,0;164.061,4,0;164.476,3,0;164.673,4,0;165.034,3,0;165.350,5,0;165.609,3,0;165.913,5,0;166.208,3,0;166.517,6,0;166.786,3,0;167.116,6,0;167.390,3,0;167.713,5,0;168.000,3,0;168.308,5,0;168.623,3,0;168.940,4,0;169.218,3,0;169.516,4,0;169.819,3,0;170.098,5,0;170.459,3,0;170.693,5,0;171.297,6,0;171.530,3,0;171.907,6,0;172.250,3,0;172.520,5,0;172.822,3,0;173.366,1,0;174.137,1,0;174.779,2,0;175.254,2,0;175.812,3,0;176.363,3,0;176.992,4,0;177.583,4,0;178.281,3,0;178.908,3,0;179.434,2,0;180.011,2,0;180.620,1,0;181.275,1,0;181.861,2,0;182.428,2,0;182.984,6,0;183.588,6,0;184.180,5,0;184.774,5,0;185.386,4,0;185.971,4,0;186.619,3,0;187.257,3,0;187.791,4,0;188.447,4,0;188.931,5,0;189.499,5,0;190.129,6,0;190.787,6,0;191.371,1,0;191.452,2,0;191.531,3,0;191.759,4,0;191.839,5,0;192.053,6,0;192.109,5,0;192.234,4,0;192.384,3,0;192.515,2,0;192.630,1,0;195.116,1,0;197.651,1,0;198.802,2,0;200.034,2,0;200.932,3,0;202.313,3,0;203.546,4,0;204.498,4,0;205.601,5,0;206.911,5,0;208.063,6,0;209.268,6,0;210.600,5,0;211.743,5,0;212.919,4,0;214.162,4,0;215.411,6,0;215.683,3,0;216.021,6,0;216.259,3,0;216.629,6,0;216.881,2,0;217.240,6,0;217.583,2,0;217.817,6,0;218.105,1,0;218.491,6,0;218.707,1,0;219.094,6,0;219.246,2,0;219.651,6,0;219.914,2,0;220.245,1,0;220.391,2,0;220.543,3,0;220.768,4,0;220.941,5,0;221.084,6,0;221.451,6,0;221.522,5,0;221.662,4,0;221.852,3,0;222.018,2,0;222.157,1,0;222.612,1,0;222.737,2,0;222.866,3,0;223.129,4,0;223.244,5,0;223.388,6,0;223.827,6,0;223.900,5,0;224.000,4,0;224.223,3,0;224.359,2,0;224.496,1,0;225.011,6,0;225.203,1,0;225.342,6,0;225.512,1,0;225.626,6,0;225.762,1,0;225.897,6,0;226.058,2,0;226.260,5,0;226.382,2,0;226.566,5,0;226.700,2,0;226.851,5,0;227.021,2,0;227.171,5,0;227.371,3,0;227.479,4,0;227.650,3,0;227.783,4,0;228.039,3,0;228.183,4,0;228.337,3,0;228.587,5,0;228.679,2,0;228.858,5,0;229.004,2,0;229.162,5,0;229.326,2,0;229.479,5,0;229.650,1,0;229.802,6,0;229.961,1,0;230.116,6,0;230.270,1,0;230.441,6,0;230.611,1,0;230.739,6,0;230.890,2,0;231.089,5,0;231.215,2,0;231.363,5,0;231.493,2,0;231.675,5,0;231.989,3,0;232.189,4,0;232.324,3,0;232.475,4,0;232.640,3,0;232.835,4,0;232.960,3,0;233.131,4,0;233.293,2,0;233.430,5,0;233.642,2,0;233.805,5,0;233.968,2,0;234.661,1,0;235.274,1,0;235.902,1,0;236.009,2,0;236.110,3,0;236.317,4,0;236.425,5,0;236.641,6,0;236.694,5,0;236.794,4,0;237.037,1,0;237.631,1,0;238.250,1,0;238.341,2,0;238.394,3,0;238.610,4,0;238.689,5,0;238.854,6,0;238.945,5,0;238.999,4,0;239.394,6,0;240.060,6,0;240.573,6,0;240.627,5,0;240.708,4,0;240.789,3,0;240.907,2,0;241.143,1,0;241.206,2,0;241.339,3,0;241.824,6,0;242.473,6,0;243.033,6,0;243.092,5,0;243.150,4,0;243.299,3,0;243.418,2,0;243.597,1,0;243.762,2,0;243.919,3,0;244.243,6,0;244.873,6,0;245.459,1,0;246.082,1,0;246.674,5,0;247.314,5,0;247.852,2,0;248.453,2,0;248.973,3,0;248.987,4,0;249.185,2,0;249.187,5,0;249.535,1,0;249.548,6,0;250.156,3,0;250.164,4,0;250.492,5,0;250.499,2,0;250.794,6,0;250.802,1,0;251.434,3,0;251.443,4,0;251.714,2,0;251.740,5,0;252.018,1,0;252.042,6,0;252.666,1,0;252.739,2,0;252.824,3,0;252.991,4,0;253.073,5,0;253.315,6,0;253.378,5,0;253.466,4,0;253.560,3,0;253.657,2,0;253.746,1,0;255.644,1,0;255.730,2,0;255.806,3,0;255.915,4,0;255.962,5,0;256.209,6,0;256.258,5,0;256.346,4,0;256.428,3,0;256.555,2,0;256.627,1,0;256.973,1,0;257.066,2,0;257.159,3,0;257.302,4,0;257.396,5,0;257.616,6,0;257.688,5,0;257.761,4,0;257.886,3,0;257.984,2,0;258.183,1,0;258.335,2,0;258.443,3,0;258.614,4,0;258.778,5,0;258.825,6,0;259.111,6,0;259.154,1,0;259.307,6,0;259.417,1,0;259.568,6,0;259.685,1,0;259.785,6,0;259.938,1,0;260.055,6,0;260.135,1,0;260.439,2,0;260.560,5,0;260.655,2,0;260.784,5,0;260.890,2,0;261.048,5,0;261.140,2,0;261.330,5,0;261.485,3,0;261.603,4,0;261.756,3,0;261.827,4,0;261.971,3,0;262.087,4,0;262.257,3,0;262.389,4,0;262.604,2,0;262.698,5,0;262.837,2,0;262.944,5,0;263.059,2,0;263.222,5,0;263.358,2,0;263.548,5,0;263.971,1,0;264.276,1,0;264.563,1,0;264.859,1,0;265.164,1,0;265.210,6,0;265.381,6,0;265.403,1,0;265.571,6,0;265.578,1,0;265.731,6,0;265.799,1,0;265.939,6,0;266.011,1,0;266.137,6,0;266.523,6,0;266.739,6,0;267.018,6,0;267.295,6,0;267.479,6,0;267.812,6,0;268.097,6,0;268.331,6,0;268.828,3,0;269.000,4,0;269.187,3,0;269.269,4,0;269.439,3,0;269.547,4,0;269.696,3,0;269.821,4,0;269.945,3,0;270.245,2,0;270.304,5,0;270.479,2,0;270.519,5,0;270.784,2,0;270.853,5,0;271.055,5,0;271.130,2,0;271.346,5,0;271.563,1,0;271.978,6,0;272.049,1,0;272.229,6,0;272.344,1,0;272.651,2,0;272.751,5,0;272.803,4,0;272.842,3,0;273.651,1,0;273.923,2,0;274.226,3,0;274.874,6,0;275.137,5,0;275.414,4,0;276.053,1,0;276.306,2,0;276.615,3,0;277.259,6,0;277.536,5,0;277.864,4,0;278.447,1,0;278.699,2,0;279.015,3,0;279.633,6,0;279.960,5,0;280.245,4,0;281.010,1,0;281.236,2,0;281.535,3,0;282.090,6,0;282.370,5,0;282.631,4,0;283.179,3,0;283.485,4,0;283.828,3,0;284.042,4,0;284.402,2,0;284.757,5,0;285.051,2,0;285.310,5,0;285.664,1,0;285.955,6,0;286.267,1,0;286.500,6,0;286.878,2,0;287.174,5,0;287.425,2,0;287.693,5,0;288.040,3,0;288.363,4,0;288.615,3,0;288.912,4,0;289.200,2,0;289.496,5,0;289.882,2,0;290.126,5,0;290.530,1,0;290.827,2,0;291.242,3,0;291.566,4,0;292.061,5,0;292.430,6,0;292.819,5,0;293.829,4,0;294.163,3,0;294.420,4,0;294.843,3,0;295.130,4,0;295.554,2,0;296.482,2,0;296.867,2,0;297.220,3,0;297.587,2,0;297.956,1,0;298.323,6,0;298.682,5,0;298.990,4,0;299.284,5,0;299.620,6,0;300.826,1,0;301.131,2,0;301.591,3,0;301.887,2,0;302.355,1,0;303.540,6,0;304.875,6,0;305.207,5,0;305.499,4,0;305.836,3,0;306.250,4,0;307.115,4,0;307.521,4,0;307.889,5,0;308.189,4,0;308.522,3,0;308.944,2,0;309.617,1,0;310.229,2,0;311.523,3,0;312.219,4,0;313.020,5,0;314.574,6,0; ";
audiogame.leveldata2 ="2.917,1,0;4.412,6,0;6.105,2,0;7.616,5,0;9.210,3,0;15.463,3,0;15.932,2,0;16.334,1,0;17.163,4,0;17.559,5,0;17.928,6,0;18.739,3,0;19.098,2,0;19.520,1,0;21.761,4,0;22.247,5,0;22.661,6,0;23.381,3,0;23.867,2,0;24.334,1,0;24.918,4,0;25.434,5,0;25.900,6,0;26.782,1,0;26.881,2,0;26.990,3,0;27.160,4,0;27.260,5,0;27.458,6,0;27.593,5,0;27.709,4,0;28.294,3,0;28.548,1,0;29.187,4,0;29.348,6,0;29.897,3,0;30.011,1,0;30.671,4,0;30.768,6,0;31.508,3,0;31.634,1,0;32.252,4,0;32.379,6,0;33.053,3,0;33.180,1,0;33.819,4,0;33.953,6,0;34.594,3,0;34.693,1,0;35.392,4,0;35.519,6,0;36.221,3,0;36.338,1,0;36.978,4,0;37.084,6,0;37.814,3,0;37.932,1,0;38.524,4,0;38.668,6,0;39.325,3,0;39.467,1,0;40.109,4,0;40.236,6,0;40.972,1,0;41.773,1,0;42.646,1,0;43.494,1,0;44.257,1,0;45.004,1,0;45.869,1,0;46.668,1,0;47.381,6,0;48.207,1,0;49.045,1,0;49.772,1,0;50.620,1,0;51.384,1,0;52.185,1,0;52.956,1,0;53.713,3,0;53.723,4,0;54.109,3,0;54.126,4,0;54.478,2,0;54.494,5,0;54.892,6,0;54.902,1,0;55.324,4,0;55.324,3,0;57.150,3,0;57.773,2,0;58.538,4,0;58.761,5,0;58.907,6,0;59.104,5,0;60.103,4,0;60.127,3,0;60.832,3,0;60.850,4,0;61.716,2,0;62.046,3,0;62.344,4,0;62.514,5,0;62.748,4,0;63.667,3,0;63.982,4,0;64.188,3,0;64.368,4,0;64.540,3,0;65.402,3,0;65.443,4,0;65.923,4,0;65.924,3,0;66.483,1,0;66.806,2,0;67.220,3,0;68.084,6,0;68.524,5,0;68.916,4,0;69.685,3,0;70.041,4,0;70.434,3,0;70.811,4,0;71.100,3,0;71.388,4,0;71.980,3,0;72.844,1,0;73.194,2,0;73.638,3,0;74.465,6,0;74.886,5,0;75.221,4,0;75.976,3,0;76.380,4,0;76.778,5,0;76.813,2,0;77.415,1,0;77.425,6,0;77.748,2,0;77.774,5,0;78.029,4,0;78.037,3,0;79.053,1,0;79.459,2,0;79.944,3,0;80.808,6,0;81.212,5,0;81.566,4,0;82.357,4,0;82.399,3,0;82.752,5,0;82.760,2,0;83.112,4,0;83.119,3,0;83.941,4,0;83.957,3,0;84.344,2,0;84.353,5,0;84.705,4,0;84.740,3,0;85.612,1,0;85.892,2,0;86.288,3,0;87.204,6,0;87.583,5,0;87.924,4,0;88.716,3,0;88.726,4,0;89.105,2,0;89.115,5,0;89.445,4,0;89.465,3,0;90.121,3,0;90.525,4,0;90.932,2,0;91.258,5,0;91.956,1,0;92.316,2,0;92.677,1,0;93.122,2,0;93.517,1,0;93.865,2,0;94.276,1,0;94.666,2,0;95.097,1,0;95.493,2,0;95.924,1,0;96.349,2,0;96.725,1,0;97.060,2,0;97.464,1,0;97.862,2,0;98.338,2,0;98.660,3,0;99.084,2,0;99.478,3,0;99.887,2,0;100.226,3,0;100.679,2,0;101.053,3,0;101.441,2,0;101.837,3,0;102.269,2,0;102.638,3,0;103.038,4,0;103.357,5,0;103.654,4,0;104.014,6,0;105.049,6,0;105.813,6,0;106.561,6,0;107.372,6,0;107.820,5,0;108.621,5,0;108.964,6,0;109.215,5,0;109.630,4,0;110.951,6,0;111.735,6,0;112.536,6,0;113.346,6,0;114.119,6,0;114.941,6,0;115.740,6,0;116.495,6,0;117.315,3,0;117.323,4,0;117.736,5,0;117.746,2,0;118.087,6,0;118.116,1,0;118.917,6,0;119.608,5,0;120.148,4,0;121.013,3,0;121.330,4,0;121.580,3,0;122.252,6,0;122.370,5,0;122.506,4,0;123.748,4,0;123.791,3,0;124.099,3,0;124.109,4,0;124.430,2,0;124.440,5,0;125.284,3,0;125.308,4,0;126.061,3,0;126.069,4,0;127.364,1,0;127.678,2,0;128.057,1,0;128.948,6,0;130.019,1,0;130.389,2,0;130.847,3,0;131.261,4,0;131.413,3,0;132.414,6,0;132.839,6,0;133.206,5,0;133.629,4,0;134.041,3,0;134.581,6,0;135.111,6,0;135.328,5,0;135.625,4,0;136.013,3,0;136.410,3,0;136.806,2,0;137.199,1,0;139.378,4,0;139.398,3,0;139.775,3,0;139.790,4,0;140.026,2,0;140.043,5,0;140.356,3,0;140.367,4,0;140.961,6,0;140.988,1,0;141.330,2,0;141.357,5,0;141.572,4,0;141.582,3,0;142.594,1,0;143.013,2,0;143.535,3,0;144.359,4,0;144.744,3,0;145.127,4,0;145.516,3,0;145.931,4,0;146.359,3,0;146.702,4,0;147.051,3,0;147.492,4,0;147.814,3,0;148.250,4,0;148.701,3,0;149.086,6,0;149.537,5,0;149.977,4,0;150.797,3,0;152.237,4,0;152.661,3,0;153.002,4,0;153.450,3,0;153.811,4,0;154.225,3,0;154.566,4,0;154.916,3,0;155.521,1,0;155.837,2,0;156.276,1,0;156.681,2,0;157.085,6,0;157.438,5,0;157.869,6,0;158.273,5,0;158.678,1,0;158.996,2,0;159.444,1,0;159.858,2,0;160.253,6,0;160.597,5,0;161.010,6,0;161.404,5,0;161.811,2,0;162.206,3,0;162.613,2,0;163.047,3,0;163.478,5,0;163.802,4,0;164.207,5,0;164.599,4,0;165.022,2,0;165.418,3,0;165.841,2,0;166.282,2,0;166.605,3,0;166.663,4,0;166.928,4,0;166.940,3,0;167.291,5,0;167.301,2,0;167.604,1,0;167.641,6,0;168.334,3,0;168.604,4,0;168.765,3,0;169.207,4,0;169.585,2,0;169.612,5,0;169.991,2,0;170.008,5,0;171.303,3,0;171.771,4,0;172.122,5,0;172.575,6,0;172.754,5,0;173.157,4,0;174.483,3,0;174.695,2,0;174.813,1,0;175.280,2,0;175.766,3,0;176.135,2,0;176.522,1,0;176.865,2,0;177.755,3,0;177.765,4,0;178.349,3,0;178.374,4,0;178.709,5,0;178.717,2,0;179.077,4,0;179.076,3,0;180.823,1,0;181.021,3,0;181.309,1,0;181.453,3,0;181.740,2,0;181.859,4,0;182.074,2,0;182.228,4,0;182.461,3,0;182.613,5,0;182.892,3,0;183.045,5,0;183.530,6,0;184.437,1,0;184.459,6,0;184.811,2,0;184.846,5,0;185.665,1,0;185.799,6,0;185.857,2,0;185.953,5,0;186.123,3,0;186.139,4,0;187.213,6,0;187.401,4,0;187.698,6,0;187.761,4,0;188.130,2,0;188.236,5,0;188.518,2,0;188.606,5,0;188.840,1,0;189.148,4,0;189.282,1,0;189.452,4,0;189.635,1,0;189.892,4,0;190.050,1,0;190.810,1,0;190.820,6,0;191.180,2,0;191.225,5,0;191.541,3,0;191.577,4,0;191.775,2,0;191.801,5,0;192.548,1,0;192.565,6,0;193.606,1,0;194.005,2,0;194.420,3,0;194.770,4,0;194.976,5,0;196.067,6,0;196.316,5,0;196.435,4,0;196.696,3,0;197.113,4,0;197.254,3,0;197.498,4,0;197.650,3,0;197.857,4,0;198.037,3,0;198.405,2,0;198.607,5,0;198.786,2,0;198.971,5,0;199.171,2,0;199.402,5,0;199.548,2,0;199.940,1,0;199.962,6,0;200.340,2,0;200.386,5,0;200.792,4,0;200.799,3,0;201.620,3,0;201.782,4,0;201.969,3,0;202.168,4,0;202.373,3,0;202.573,4,0;202.744,3,0;203.229,2,0;203.444,5,0;203.581,2,0;203.850,5,0;203.985,2,0;204.534,6,0;204.598,1,0;204.892,6,0;204.904,1,0;205.126,1,0;205.149,6,0;206.190,3,0;206.208,4,0;206.719,2,0;206.721,5,0;207.117,1,0;207.124,6,0;207.971,3,0;207.989,4,0;208.331,2,0;208.349,5,0;208.726,6,0;208.736,1,0;209.501,1,0;209.508,6,0;209.941,2,0;209.988,5,0;210.301,3,0;210.311,4,0;211.005,2,0;211.031,5,0;211.435,1,0;211.444,6,0;211.850,2,0;211.869,5,0;212.675,3,0;213.117,3,0;213.506,4,0;213.947,2,0;214.101,5,0;215.088,6,0;215.116,1,0;215.432,2,0;215.492,5,0;215.738,4,0;215.746,3,0;216.101,2,0;216.137,5,0;216.330,1,0;216.349,6,0;216.599,2,0;216.636,5,0;216.894,4,0;216.906,3,0;217.358,5,0;217.724,2,0;218.068,6,0;218.416,1,0;219.336,3,0;219.373,4,0;219.965,5,0;219.974,2,0;220.713,6,0;220.721,1,0;221.470,2,0;221.485,5,0;221.829,3,0;221.832,4,0;222.196,2,0;222.206,5,0;223.053,1,0;223.061,6,0;223.852,4,0;224.070,3,0;224.365,5,0;224.547,2,0;224.847,6,0;224.969,1,0;225.442,3,0;225.761,4,0;225.997,2,0;226.184,5,0;226.408,1,0;226.637,6,0;227.077,3,0;227.244,4,0;227.454,2,0;227.668,5,0;227.920,1,0;228.180,6,0;228.633,1,0;228.676,6,0;228.947,2,0;228.999,5,0;229.307,3,0;229.317,4,0;230.143,1,0;230.157,6,0;230.438,2,0;230.461,5,0;230.746,3,0;230.767,4,0;234.623,6,0.96;234.723,6,0.96;234.823,6,0.96;234.923,6,0.96;235.023,6,0.96;235.123,6,0.96;235.223,6,0.96;235.323,6,0.96;235.423,6,0.96;235.523,6,0.96;237.686,1,0.94;237.786,1,0.94;237.886,1,0.94;237.986,1,0.94;238.086,1,0.94;238.186,1,0.94;238.286,1,0.94;238.386,1,0.94;238.486,1,0.94;238.586,1,0.94;239.4200,4,0.42;239.5200,4,0.42;239.6200,4,0.42;239.7200,4,0.42;239.8200,4,0.42;239.705,3,0;240.061,4,0;240.446,3,0; ";
audiogame.leveldata3="9.762,1,0;10.236,2,0;10.714,3,0;11.650,4,0;12.057,5,0;12.602,6,0;13.569,1,0;14.524,2,0;15.426,1,0;16.345,2,0;17.298,6,0;18.170,5,0;19.202,6,0;20.170,5,0;21.099,3,0;21.298,2,0;21.514,1,0;21.738,2,0;22.002,3,0;22.962,4,0;23.386,4,0;23.850,4,0;24.506,4,0;24.763,1,0;25.258,1,0;25.746,1,0;26.210,1,0;26.658,1,0;27.098,1,0;27.593,1,0;28.058,1,0;28.514,6,0;28.962,6,0;29.393,6,0;29.881,6,0;30.321,6,0;30.810,6,0;31.281,6,0;31.785,6,0;32.257,4,0;32.265,3,0;32.489,2,0;32.509,5,0;32.722,1,0;32.729,6,0;33.145,4,0;33.176,3,0;33.417,5,0;33.425,2,0;33.673,6,0;33.693,1,0;34.129,4,0;34.153,3,0;34.353,2,0;34.361,5,0;34.585,1,0;34.602,6,0;35.098,4,0;35.114,3,0;35.305,5,0;35.313,2,0;35.561,6,0;35.569,1,0;36.025,1,0;36.489,2,0;36.978,3,0;37.954,6,0;38.434,5,0;38.850,4,0;39.786,1,0;40.002,2,0;40.234,1,0;40.442,2,0;40.714,1,0;41.658,6,0;41.850,5,0;42.131,6,0;42.394,5,0;42.602,6,0;42.810,5,0;43.066,6,0;44.809,3,0.44;44.909,3,0.44;45.009,3,0.44;45.109,3,0.44;45.209,3,0.44;46.8530,4,0.49;46.9530,4,0.49;47.0530,4,0.49;47.1530,4,0.49;47.2530,4,0.49;47.353,5,0;47.404,2,0;48.273,4,0;48.289,3,0;49.241,1,0;49.657,2,0;50.097,6,0;50.569,5,0;51.105,4,0;51.145,3,0;52.218,5,0;52.227,2,0;52.970,6,0;52.977,1,0;53.377,2,0;53.402,5,0;53.842,6,0;53.861,1,0;54.329,5,0;54.337,2,0;54.818,1,0;55.043,2,0;55.257,3,0;56.618,4,0;56.882,5,0;57.123,6,0;58.643,1,0;59.634,3,0;60.580,1,0;61.338,2,0;61.554,1,0;61.826,2,0;62.922,6,0;63.922,5,0;64.754,6,0;65.065,5,0;65.257,6,0;65.553,5,0;67.898,3,0;67.906,4,0;68.146,2,0;68.154,5,0;68.377,6,0;68.393,1,0;68.810,3,0;68.817,4,0;69.041,5,0;69.065,2,0;69.323,1,0;69.330,6,0;70.289,1,0;70.458,2,0;70.753,3,0;71.634,6,0;71.906,5,0;72.138,4,0;73.754,3,0;74.074,2,0;74.509,3,0;75.442,4,0;75.674,5,0;76.202,4,0;76.826,5,0;77.762,1,0;78.218,3,0;78.658,1,0;79.170,4,0;79.611,6,0;80.097,4,0;81.074,4,0;81.108,1,0;81.985,5,0;81.993,2,0;82.417,4,0;82.457,1,0;82.897,3,0;82.907,6,0;83.369,2,0;83.401,5,0;83.810,6,0;83.817,3,0;84.761,1,0;85.217,2,0;85.681,3,0;86.729,6,0;87.206,5,0;87.661,4,0;88.530,6,0;88.554,1,0;88.738,2,0;88.792,5,0;88.985,3,0;89.025,4,0;89.457,2,0;89.473,5,0;89.969,1,0;89.985,6,0;90.426,1,0;90.434,6,0;90.906,1,0;90.914,6,0;91.394,1,0;91.826,2,0;92.338,3,0;92.759,4,0;93.258,5,0;93.717,6,0;94.186,5,0;94.618,4,0;95.106,3,0;95.538,2,0;96.042,1,0;96.498,2,0;96.994,1,0;97.465,2,0;97.946,6,0;98.369,6,0;98.849,6,0;99.314,6,0;99.769,3,0;100.713,4,0;101.658,2,0;102.601,5,0;103.537,1,0;104.506,6,0;105.450,2,0;106.419,5,0;107.297,3,0;108.266,4,0;109.170,2,0;110.139,5,0;111.082,1,0;111.306,6,0;111.490,2,0;111.762,5,0;111.962,3,0;112.178,4,0;112.414,2,0;112.666,5,0;112.914,1,0;113.130,6,0;113.382,2,0;113.650,5,0;113.836,3,0;114.042,4,0;114.338,2,0;114.523,5,0;114.818,1,0;115.265,6,0;115.746,2,0;115.762,5,0;116.175,3,0;116.177,4,0;116.649,5,0;116.889,6,0;117.153,5,0;117.362,4,0;117.858,3,0;118.105,2,0;118.553,1,0;119.217,2,0;119.477,3,0;119.946,4,0;120.481,3,0;120.913,4,0;121.338,3,0;121.762,4,0;122.217,3,0;122.521,3,0;122.754,3,0;123.177,4,0;123.393,4,0;123.673,4,0;124.113,2,0;124.337,2,0;124.570,2,0;124.826,3,0;125.346,2,0;125.586,3,0;125.978,4,0;126.202,4,0;126.450,4,0;126.923,3,0;127.194,3,0;127.402,3,0;127.898,4,0;128.098,4,0;128.346,4,0;128.802,5,0;128.994,5,0;129.234,5,0;129.458,4,0;129.738,5,0;130.700,1,0;131.194,3,0;131.690,6,0;132.105,4,0;132.594,1,0;133.043,3,0;133.514,6,0;133.987,4,0;134.449,1,0;134.906,3,0;135.386,6,0;135.843,4,0;136.349,1,0;136.762,3,0;137.201,1,0;137.697,2,0;138.202,1,0;139.154,6,0;139.585,5,0;140.025,6,0;141.073,3,0;141.994,4,0;142.986,3,0;143.370,4,0;143.851,3,0;144.746,3,0;144.986,2,0;145.234,3,0;145.722,4,0;145.962,5,0;146.170,4,0;146.650,3,0;146.866,2,0;147.114,3,0;147.570,4,0;147.830,5,0;148.082,4,0;148.522,3,0;148.754,2,0;149.018,3,0;149.490,4,0;149.698,5,0;149.905,4,0;150.369,3,0;150.617,2,0;150.873,3,0;151.381,4,0;151.618,5,0;151.842,4,0;152.292,1,0;152.716,2,0;153.242,3,0;154.153,6,0;155.153,6,0;156.078,1,0;156.450,2,0;156.945,3,0;157.937,6,0;158.862,6,0;160.066,2,0;161.058,1,0;161.954,3,0;162.875,5,0;163.746,6,0;164.627,4,0;166.558,3,0.38;166.658,3,0.38;166.758,3,0.38;166.858,3,0.38;167.210,1,0;167.756,2,0;168.202,3,0;169.211,6,0;169.706,5,0;170.157,4,0;171.074,1,0;171.524,2,0;171.985,3,0;172.953,6,0;173.450,5,0;173.865,4,0;175.334,1,0.19;175.434,1,0.19;175.801,2,0;177.254,6,0.2;177.354,6,0.2;177.454,6,0.2;177.618,5,0;178.588,3,0;179.018,2,0;179.482,1,0;180.386,6,0;180.804,6,0;181.306,6,0;182.242,1,0;182.650,2,0;182.850,3,0;183.682,6,0;183.882,5,0;184.125,4,0;185.035,1,0;185.226,2,0;185.498,3,0;186.274,6,0;186.513,5,0;186.689,4,0;187.465,3,0;187.960,2,0;188.434,1,0;188.881,4,0;189.330,5,0;189.818,6,0;190.298,3,0;190.658,3,0;191.215,4,0;191.396,3,0;191.649,5,0;191.810,2,0;192.194,5,0;192.386,1,0;192.905,6,0;195.402,4,0;195.410,3,0;195.866,4,0;195.880,3,0;196.346,4,0;196.367,3,0;196.794,2,0;196.810,5,0;197.714,3,0;197.977,4,0;198.234,3,0;198.459,4,0;198.682,3,0;198.946,4,0;199.170,2,0;199.386,5,0;199.570,2,0;199.858,5,0;200.370,2,0;200.674,5,0;201.098,1,0;201.258,6,0;201.522,1,0;201.746,6,0;202.001,1,0;202.234,6,0;202.474,1,0;202.609,6,0;203.000,2,0;203.185,5,0;203.378,2,0;203.638,5,0;203.803,2,0;204.068,5,0;204.258,2,0;204.785,1,0;204.961,2,0;205.257,1,0;205.505,2,0;205.785,1,0;206.038,2,0;206.251,1,0;206.634,2,0;206.843,3,0;207.129,2,0;207.361,3,0;207.602,2,0;207.861,3,0;208.050,2,0;208.514,4,0;208.817,5,0;208.937,4,0;209.225,5,0;209.459,4,0;209.762,5,0;209.905,4,0;210.289,5,0;210.562,6,0;210.761,5,0;211.049,6,0;211.217,5,0;211.503,6,0;211.705,5,0;212.217,1,0;212.282,2,0;212.377,3,0;";
//歌詞按鈕順序
audiogame.isRecordMode=false;
var c=0,c1=0,c2=0,c3=0,c4=0,c5=0,c6=0,clickMid=1,clickRight=2,clickLeft=3,songnumber=2,leveldata;
var t1,t2,t3,t4,t5,t6,flotime1=0,flotime2=0,flotime3=0,flotime4=0,flotime5=0,flotime6=0,q=0;
var miss=0,great=0,perfect=0,combo=0,totalscore=0 ;
flotime=[];

var boolen1,boolen2,boolen3,boolen4,boolen5,boolen6;//長案
$(function(){

	audiogame.melody = document.getElementById("melody");	
	audiogame.base = document.getElementById("base");
	audiogame.btnOverSound = document.getElementById("btn_over");		//移過去音樂
	audiogame.btnOverSound.volume = .7;
	audiogame.btnRightSound = document.getElementById("btn_right");		//右鍵移過去音樂
	audiogame.btnRightSound.volume = 1;		
	audiogame.btnActiveSound = document.getElementById("btn_active");	//點擊開始音樂
	audiogame.btnActiveSound.volume = .7;
	audiogame.jerryclittle = document.getElementById("jerryclittle");	//jerryC試聽
	audiogame.jerryclittle.volume = .6;
	audiogame.ffltlittle = document.getElementById("ffltlittle");	//inialD試聽
	audiogame.ffltlittle.volume = .4;
	audiogame.keshalittle = document.getElementById("keshalittle");	//kesha試聽
	audiogame.keshalittle.volume = .6;
	audiogame.jerryc = document.getElementById("jerryc");	//jerryC
	$(audiogame.jerryc).bind('ended',onGameEnded);
	audiogame.jerryc.volume = 1;
	audiogame.fflt = document.getElementById("fflt");	//inialD
	$(audiogame.fflt).bind('ended',onGameEnded);
	audiogame.fflt.volume = 1;
	audiogame.kesha = document.getElementById("kesha");	//kesha
	$(audiogame.kesha).bind('ended',onGameEnded);
	audiogame.kesha.volume = 1;
	
	audiogame.dotImage.src="img/dot6.png";
	flotime[1]=0;
	flotime[2]=0;
	flotime[3]=0;
	flotime[4]=0;
	flotime[5]=0;
	flotime[6]=0;
	//開始按鈕
	$("a[href='#game']").hover(function(){  //移過去音樂
		audiogame.btnOverSound.currentTime = 0;
		audiogame.btnOverSound.play();
	},function(){     //移開就暫停
		audiogame.btnOverSound.pause();
	})
	.click(function(){//點擊開始
		audiogame.btnActiveSound.currentTime = 0;
		audiogame.btnActiveSound.play();
		$("#chage-scene").addClass('show-scene');
		//$("#game-scene").addClass('show-scene');	//遊戲背景
		//$("#chageCD-scene").addClass('show-scene');	//遊戲背景
		
		return false;
	})
	$("a[href='#right']").click(function(){
		audiogame.btnRightSound.play();
		$("#album1").removeClass('class'+clickMid);
		$("#album2").removeClass('class'+clickRight);
		$("#album3").removeClass('class'+clickLeft);
		
		clickMid--;
		clickRight--;
		clickLeft--;

		$("#album1").addClass('class'+clickMid);
		$("#album2").addClass('class'+clickRight);
		$("#album3").addClass('class'+clickLeft);
		console.log("clickMid="+clickMid);
		console.log("clickRight="+clickRight);
		console.log("clickLeft="+clickLeft);
		
		$("a[href='#left']").removeClass('rfhide');
		$("a[href='#left']").addClass('rfshow');
		if(clickMid==0){
		$("a[href='#right']").removeClass('rfshow');
		$("a[href='#right']").addClass('rfhide');
		}
		
		if(clickMid==2){
		
		}
		if(clickRight==2){
			audiogame.keshalittle.pause();
			audiogame.jerryclittle.pause();
			audiogame.ffltlittle.load();
			audiogame.ffltlittle.play();
			songnumber=2;
		}
		if(clickLeft==2){
			audiogame.jerryclittle.pause();
			audiogame.ffltlittle.pause();
			audiogame.keshalittle.load();
			audiogame.keshalittle.play();
			songnumber=3;
		}

	})
	
	$("a[href='#left']").click(function(){
		audiogame.btnRightSound.play();
		
		$("#album1").removeClass('class'+clickMid);
		$("#album2").removeClass('class'+clickRight);
		$("#album3").removeClass('class'+clickLeft);
		
		clickMid++;
		clickRight++;
		clickLeft++;
		
		$("#album1").addClass('class'+clickMid);
		$("#album2").addClass('class'+clickRight);
		$("#album3").addClass('class'+clickLeft);
		
		console.log("clickMid="+clickMid);
		console.log("clickRight="+clickRight);
		console.log("clickLeft="+clickLeft);
		$("a[href='#right']").removeClass('rfhide');
		$("a[href='#right']").addClass('rfshow');
		if(clickLeft==4){
			$("a[href='#left']").removeClass('rfshow');
			$("a[href='#left']").addClass('rfhide');
		}
		if(clickMid==2){
			audiogame.ffltlittle.pause();
			audiogame.jerryclittle.load();
			audiogame.jerryclittle.play();
			songnumber=1;
		}
		if(clickRight==2){
			audiogame.keshalittle.pause();
			audiogame.jerryclittle.pause();
			audiogame.ffltlittle.load();
			audiogame.ffltlittle.play();
			songnumber=2;
		}
		if(clickLeft==2){
		
			
		}

	})

	$("a[href='#start']").click(function(){

		$("#game-scene").addClass('show-scene');
		//console.log("song:"+songnumber);
		audiogame.keshalittle.pause();
		audiogame.jerryclittle.pause();
		audiogame.ffltlittle.pause();
		startGame();	//開始遊戲
	})
	
	
	$(document).keydown(function(e){
		if (audiogame.isRecordMode){//紀錄模式
			if(e.which==186){
				var musicNotesString="";
				for(var i in audiogame.musicNotes){
						musicNotesString += audiogame.musicNotes[i].time+","+audiogame.musicNotes[i].line+","+audiogame.musicNotes[i].continuous+";";
				}
					console.log("level:"+musicNotesString);
			}

			var chageline=0;
			switch(e.keyCode){
				case 83: //S
					boolen1=true;
					$('#hit-line-1').removeClass('hide');
					$('#hit-line-1').addClass('show');	
					if(flotime1>0.1){
						flotime[1]=flotime1;
					}
					else{
						flotime[1]=0;
					}				
					break;
				case 68: //D
					boolen2=true;
					$('#hit-line-2').removeClass('hide');
					$('#hit-line-2').addClass('show'); 
					if(flotime2>0.1){
						flotime[2]=flotime2;
					}
					else{
						flotime[2]=0;
					}
					break;	
				case 70: //F
					boolen3=true;
					$('#hit-line-3').removeClass('hide');
					$('#hit-line-3').addClass('show'); 
					if(flotime3>0.1){
						flotime[3]=flotime3;
					}
					else{
						flotime[3]=0;
					}
					break;	
				case 74: //J
					boolen4=true;
					var currentTime =audiogame.melody.currentTime.toFixed(3);
					$('#hit-line-4').removeClass('hide');
					$('#hit-line-4').addClass('show');
					if(flotime4>0.1){
						flotime[4]=flotime4;
					}					
					else{
						flotime[4]=0;
					}	
					break;						
				
				case 75: //K
					boolen5=true;
					var currentTime =audiogame.melody.currentTime.toFixed(3);
					$('#hit-line-5').removeClass('hide');
					$('#hit-line-5').addClass('show');							
					if(flotime5>0.1){
						flotime[5]=flotime5;
					}
					else{
						flotime[5]=0;
					}
					break;	
					
				case 76: //L
					boolen6=true;
					var currentTime =audiogame.melody.currentTime.toFixed(3);
					$('#hit-line-6').removeClass('hide');
					$('#hit-line-6').addClass('show');							
					if(flotime6>0.1){
						flotime[6]=flotime6;
					}
					else{
						flotime[6]=0;
					}
					break;						

		   }
		}
		else{
		   	switch(e.keyCode){
				case 83: //S
				/*$("#final-scene").addClass('show-scene');
					var y=12345
					var x=y.toString();
					console.log('x(1)='+x.charAt(1));

					$("#great1").addClass('n'+x.charAt(1));
	*/
	
					boolen=true;
					$('#hit-line-1').removeClass('hide');
					$('#hit-line-1').addClass('show');
					for(var i in audiogame.dots){
						/*if(audiogame.dots[i].line == 1 && Math.abs(audiogame.dots[i].distance) < 60){
							audiogame.dots.splice(i, 1);
							audiogame.successCount++;
							audiogame.successCount=Math.min(5,audiogame.successCount);
							audiogame.totalSuccessCount++;

						}*/
						if(audiogame.dots[i].line == 1 && Math.abs(audiogame.dots[i].distance) < 60 && Math.abs(audiogame.dots[i].distance) >= 25){
							audiogame.dots.splice(i, 1);
							combo++;
							great++;
							console.log('great='+great);
							$('#sign').addClass('great');
							$('#sign').removeClass('signhide');
							$('#sign').addClass('signshow');
							var t =setTimeout("$('#sign').removeClass('signshow')",600);
							var t =setTimeout("$('#sign').addClass('signhide')",600);
							var t =setTimeout("$('#sign').removeClass('great')",600);
						}
						if(audiogame.dots[i].line == 1 && Math.abs(audiogame.dots[i].distance) < 25 && Math.abs(audiogame.dots[i].distance) >= 0){
							audiogame.dots.splice(i, 1);
							combo++
							perfect++
							console.log('perfect='+perfect);
							$('#sign').addClass('perfect');
							$('#sign').removeClass('signhide');
							$('#sign').addClass('signshow');
							var t =setTimeout("$('#sign').removeClass('signshow')",600);
							var t =setTimeout("$('#sign').addClass('signhide')",600);
							var t =setTimeout("$('#sign').removeClass('perfect')",600);
							
						}
						
					}
					
					break;
				case 68: //D
					boolenL=true;
					$('#hit-line-2').removeClass('hide');
					$('#hit-line-2').addClass('show'); 
					for(var i in audiogame.dots){
						if(audiogame.dots[i].line == 2 && Math.abs(audiogame.dots[i].distance) < 60 && Math.abs(audiogame.dots[i].distance) >= 25){
							audiogame.dots.splice(i, 1);
							combo++;
							great++;
							console.log('great='+great);
							$('#sign').addClass('great');
							$('#sign').removeClass('signhide');
							$('#sign').addClass('signshow');
							var t =setTimeout("$('#sign').removeClass('signshow')",600);
							var t =setTimeout("$('#sign').addClass('signhide')",600);
							var t =setTimeout("$('#sign').removeClass('great')",600);
							
						}
						if(audiogame.dots[i].line == 2 && Math.abs(audiogame.dots[i].distance) < 25 && Math.abs(audiogame.dots[i].distance) >= 0){
							audiogame.dots.splice(i, 1);
							combo++;
							perfect++;
							console.log('perfect='+perfect);
							$('#sign').addClass('perfect');
							$('#sign').removeClass('signhide');
							$('#sign').addClass('signshow');
							var t =setTimeout("$('#sign').removeClass('signshow')",600);
							var t =setTimeout("$('#sign').addClass('signhide')",600);
							var t =setTimeout("$('#sign').removeClass('perfect')",600);							
						}
					}
					break;	
				case 70: //F
					boolenL=true;
					$('#hit-line-3').removeClass('hide');
					$('#hit-line-3').addClass('show'); 
					for(var i in audiogame.dots){
						if(audiogame.dots[i].line == 3 && Math.abs(audiogame.dots[i].distance) < 60 && Math.abs(audiogame.dots[i].distance) >= 25){
							audiogame.dots.splice(i, 1);
							combo++;
							great++;
							console.log('great='+great);
							$('#sign').addClass('great');
							$('#sign').removeClass('signhide');
							$('#sign').addClass('signshow');
							var t =setTimeout("$('#sign').removeClass('signshow')",600);
							var t =setTimeout("$('#sign').addClass('signhide')",600);
							var t =setTimeout("$('#sign').removeClass('great')",600);							
						}
						if(audiogame.dots[i].line == 3 && Math.abs(audiogame.dots[i].distance) < 25 && Math.abs(audiogame.dots[i].distance) >= 0){
							audiogame.dots.splice(i, 1);
							combo++;
							perfect++;	
							console.log('perfect='+perfect);
							$('#sign').addClass('perfect');
							$('#sign').removeClass('signhide');
							$('#sign').addClass('signshow');
							var t =setTimeout("$('#sign').removeClass('signshow')",600);
							var t =setTimeout("$('#sign').addClass('signhide')",600);
							var t =setTimeout("$('#sign').removeClass('perfect')",600);							
						}
					}
					break;	
				case 74: //J
					boolenL=true;
					$('#hit-line-4').removeClass('hide');
					$('#hit-line-4').addClass('show');
					for(var i in audiogame.dots){
						if(audiogame.dots[i].line == 4 && Math.abs(audiogame.dots[i].distance) < 60 && Math.abs(audiogame.dots[i].distance) >= 25){
							audiogame.dots.splice(i, 1);
							combo++;
							great++;
							console.log('great='+great);
							$('#sign').addClass('great');
							$('#sign').removeClass('signhide');
							$('#sign').addClass('signshow');
							var t =setTimeout("$('#sign').removeClass('signshow')",600);
							var t =setTimeout("$('#sign').addClass('signhide')",600);
							var t =setTimeout("$('#sign').removeClass('great')",600);
						}
						if(audiogame.dots[i].line == 4 && Math.abs(audiogame.dots[i].distance) < 25 && Math.abs(audiogame.dots[i].distance) >= 0){
							audiogame.dots.splice(i, 1);
							combo++;
							perfect++;
							console.log('perfect='+perfect);
							$('#sign').addClass('perfect');
							$('#sign').removeClass('signhide');
							$('#sign').addClass('signshow');
							var t =setTimeout("$('#sign').removeClass('signshow')",600);
							var t =setTimeout("$('#sign').addClass('signhide')",600);
							var t =setTimeout("$('#sign').removeClass('perfect')",600);							
						}
					}
					break;						
				
				case 75: //K
					boolenL=true;
					$('#hit-line-5').removeClass('hide');
					$('#hit-line-5').addClass('show');
					for(var i in audiogame.dots){
						if(audiogame.dots[i].line == 5 && Math.abs(audiogame.dots[i].distance) < 60 && Math.abs(audiogame.dots[i].distance) >= 25){
							audiogame.dots.splice(i, 1);
							combo++;
							great++;
							console.log('great='+great);
							$('#sign').addClass('great');
							$('#sign').removeClass('signhide');
							$('#sign').addClass('signshow');
							var t =setTimeout("$('#sign').removeClass('signshow')",600);
							var t =setTimeout("$('#sign').addClass('signhide')",600);
							var t =setTimeout("$('#sign').removeClass('great')",600);
						}
						if(audiogame.dots[i].line == 5 && Math.abs(audiogame.dots[i].distance) < 25 && Math.abs(audiogame.dots[i].distance) >= 0){
							audiogame.dots.splice(i, 1);
							combo++;
							perfect++;
							console.log('perfect='+perfect);
							$('#sign').addClass('perfect');
							$('#sign').removeClass('signhide');
							$('#sign').addClass('signshow');
							var t =setTimeout("$('#sign').removeClass('signshow')",600);
							var t =setTimeout("$('#sign').addClass('signhide')",600);
							var t =setTimeout("$('#sign').removeClass('perfect')",600);							
						}
					}
					break;	
					
				case 76: //K
					boolenL=true;
					$('#hit-line-6').removeClass('hide');
					$('#hit-line-6').addClass('show');
					for(var i in audiogame.dots){
						if(audiogame.dots[i].line == 6 && Math.abs(audiogame.dots[i].distance) < 60 && Math.abs(audiogame.dots[i].distance) >= 25){
							audiogame.dots.splice(i, 1);
							combo++;
							great++;
							console.log('great='+great);
							$('#sign').addClass('great');
							$('#sign').removeClass('signhide');
							$('#sign').addClass('signshow');
							var t =setTimeout("$('#sign').removeClass('signshow')",600);
							var t =setTimeout("$('#sign').addClass('signhide')",600);
							var t =setTimeout("$('#sign').removeClass('great')",600);
						}
						if(audiogame.dots[i].line == 6 && Math.abs(audiogame.dots[i].distance) < 25 && Math.abs(audiogame.dots[i].distance) >= 0){
							audiogame.dots.splice(i, 1);
							combo++;
							perfect++;
							console.log('perfect='+perfect);
							$('#sign').addClass('perfect');
							$('#sign').removeClass('signhide');
							$('#sign').addClass('signshow');
							var t =setTimeout("$('#sign').removeClass('signshow')",600);
							var t =setTimeout("$('#sign').addClass('signhide')",600);
							var t =setTimeout("$('#sign').removeClass('perfect')",600);							
						}
					}
					break;						
					
		   }
		  }
	});

			
	$(document).keyup(function(e){
			switch(e.keyCode){
				case 83: //J
					boolen1=false;
					var currentTime =audiogame.kesha.currentTime.toFixed(3);
					currentTime=parseFloat(currentTime)+1.72;
					currentTime=currentTime.toFixed(3);
					$('#hit-line-1').removeClass('show');
					$('#hit-line-1').addClass('hide');
					chageline=1;
					if(flotime[1]>0){						
						for(var cut=flotime[1]/0.1;cut>=0;cut--){
							currentTime=parseFloat(currentTime)+0.1;						
							currentTime=currentTime.toFixed(3)
							var note = new MusicNote(currentTime,chageline,flotime[1]);
							audiogame.musicNotes.push(note);
						}
					}
					else{
						var note = new MusicNote(currentTime,chageline,flotime[1]);
						audiogame.musicNotes.push(note);
					}
					flotime1=0;
					break;
				case 68: //K
					boolen2=false;
					var currentTime =audiogame.kesha.currentTime.toFixed(3);
					currentTime=parseFloat(currentTime)+1.72;
					currentTime=currentTime.toFixed(3);
					$('#hit-line-2').removeClass('show');
					$('#hit-line-2').addClass('hide');
					chageline=2;
					if(flotime[2]>0){						
						for(var cut=flotime[2]/0.1;cut>=0;cut--){
							currentTime=parseFloat(currentTime)+0.1;						
							currentTime=currentTime.toFixed(3)
							var note = new MusicNote(currentTime,chageline,flotime[2]);
							audiogame.musicNotes.push(note);
						}
					}
					else{
						var note = new MusicNote(currentTime,chageline,flotime[2]);
						audiogame.musicNotes.push(note);
					}
					flotime2=0;
					break;	
				case 70: //F
					boolen3=false;
					var currentTime =audiogame.kesha.currentTime.toFixed(3);
					currentTime=parseFloat(currentTime)+1.72;
					currentTime=currentTime.toFixed(3);
					$('#hit-line-3').removeClass('show');
					$('#hit-line-3').addClass('hide');
					chageline=3;
					if(flotime[3]>0){						
						for(var cut=flotime[3]/0.1;cut>=0;cut--){
							currentTime=parseFloat(currentTime)+0.1;						
							currentTime=currentTime.toFixed(3)
							var note = new MusicNote(currentTime,chageline,flotime[3]);
							audiogame.musicNotes.push(note);
						}
					}
					else{
						var note = new MusicNote(currentTime,chageline,flotime[3]);
						audiogame.musicNotes.push(note);
					}
					flotime3=0;
					break;	
				case 74: //L
					boolen4=false;
					var currentTime =audiogame.kesha.currentTime.toFixed(3);
					currentTime=parseFloat(currentTime)+1.72;
					currentTime=currentTime.toFixed(3);
					$('#hit-line-4').removeClass('show');
					$('#hit-line-4').addClass('hide');
					chageline=4;
					if(flotime[4]>0){						
						for(var cut=flotime[4]/0.1;cut>=0;cut--){
							currentTime=parseFloat(currentTime)+0.1;						
							currentTime=currentTime.toFixed(4)
							var note = new MusicNote(currentTime,chageline,flotime[4]);
							audiogame.musicNotes.push(note);
						}
					}
					else{
						var note = new MusicNote(currentTime,chageline,flotime[4]);
						audiogame.musicNotes.push(note);
					}
					flotime4=0;	
					break;	
				case 75: //L
					boolen5=false;
					var currentTime =audiogame.kesha.currentTime.toFixed(3);
					currentTime=parseFloat(currentTime)+1.72;
					currentTime=currentTime.toFixed(3);
					$('#hit-line-5').removeClass('show');
					$('#hit-line-5').addClass('hide');
					chageline=5;
					if(flotime[5]>0){						
						for(var cut=flotime[5]/0.1;cut>=0;cut--){
							currentTime=parseFloat(currentTime)+0.1;						
							currentTime=currentTime.toFixed(3)
							var note = new MusicNote(currentTime,chageline,flotime[5]);
							audiogame.musicNotes.push(note);
						}
					}
					else{
						var note = new MusicNote(currentTime,chageline,flotime[5]);
						audiogame.musicNotes.push(note);
					}
					flotime5=0;
					break;	
					
				case 76: //L
					boolen6=false;
					var currentTime =audiogame.kesha.currentTime.toFixed(3);
					currentTime=parseFloat(currentTime)+1.72;
					currentTime=currentTime.toFixed(3);
					$('#hit-line-6').removeClass('show');
					$('#hit-line-6').addClass('hide');
					chageline=6;
					if(flotime[6]>0){						
						for(var cut=flotime[6]/0.1;cut>=0;cut--){
							currentTime=parseFloat(currentTime)+0.1;						
							currentTime=currentTime.toFixed(3)
							var note = new MusicNote(currentTime,chageline,flotime[6]);
							audiogame.musicNotes.push(note);
						}
					}
					else{
						var note = new MusicNote(currentTime,chageline,flotime[6]);
						audiogame.musicNotes.push(note);
					}
					flotime6=0;
					break;						
		   }

	});

	drawBackground();//畫線
	setInterval(gameloop,30);

	//startGame();
	
});


function drawBackground(){
	var game = document.getElementById("game-background-canvas");
	var ctx = game.getContext('2d');
		
	ctx.lineWidth = 10;
	ctx.strokeStyle = "#000";
	
	var center = game.width/2;
	
	ctx.lineWidth = 1;
	ctx.strokeStyle = "rgba(50,50,50,.8)";
	ctx.stroke();
}
function MusicNote(time,line,continuous){
	this.time = time;
	this.line = line;
	this.continuous=continuous;
}
function Dot(distance, line) {
	this.distance = distance;
	this.line = line;
	this.missed = false;
}

function playMusic(){		//撥放音樂跟背景音樂
	/*audiogame.melody.play();
	audiogame.base.play();*/
	switch(songnumber){
				case 1:
					audiogame.jerryc.load();
					audiogame.jerryc.play();
				break;
				case 2:
					audiogame.fflt.load();
					audiogame.fflt.play();
				break;
				case 3:
					audiogame.kesha.load();
					audiogame.kesha.play();
				break;
				
	}
}
function startGame(){
	var date = new Date();
	audiogame.startingTime = date.getTime();//讀取現在時間
	if(!audiogame.isRecordMode) {
		setupLevelData();			//存資料至陣列	
	}

	setTimeout(playMusic,3550);	//3.55秒後遊戲開始
}

function setupLevelData(){
	console.log("song:"+'audiogame.leveldata'+songnumber);
	if	(songnumber==1){
		audiogame.leveldata=audiogame.leveldata1;
	}
	if	(songnumber==2){
		audiogame.leveldata=audiogame.leveldata2;
	}
	if	(songnumber==3){
		audiogame.leveldata=audiogame.leveldata3;
	}
	var notes =audiogame.leveldata.split(";");	//將資料拆成多組
	for(var i in notes)	{
		var note = notes[i].split(",");			//每組分成 秒數+條
		var time = parseFloat(note[0]);
		var line = parseInt(note[1]);
		var continuous=parseFloat(note[2]);
		var musicNote = new MusicNote(time,line,continuous);
		audiogame.musicNotes.push(musicNote);	
		
	}
}


function gameloop(){
	var game = document.getElementById("game-canvas");
	var ctx = game.getContext('2d');
	
	if (audiogame.startingTime != 0){
		for(var i in audiogame.musicNotes){
			var date = new Date();
			var elapsedTime = (date.getTime() - audiogame.startingTime)/1000; //開始計時時間
			var note = audiogame.musicNotes[i];
			
			var timeDiff = note.time - elapsedTime;	
			if (timeDiff >= 0 && timeDiff <= .03){			//當快接近設定時間十
				var dot = new Dot(ctx.canvas.height-150, note.line);//將球(位置)畫出來，第幾條線
				audiogame.dots.push(dot);
			}
		}
	}
	
	for(var i in audiogame.dots){
		if(!audiogame.dots[i].missed && audiogame.dots[i].distance < -10){	//miss判斷 
			audiogame.dots[i].missed= true;
			combo=0;
			audiogame.successCount--;
			audiogame.successCount=Math.max(0,audiogame.successCount);
			miss=miss+1;
			$('#sign').addClass('misshit');
		    $('#sign').removeClass('signhide');
			$('#sign').addClass('signshow');
			var t =setTimeout("$('#sign').removeClass('signshow')",600);
			var t =setTimeout("$('#sign').addClass('signhide')",600);
			var t =setTimeout("$('#sign').removeClass('misshit')",600);
							
			console.log('miss='+miss);
		}
		if(audiogame.dots[i].distance < -100){	
			audiogame.dots.splice(i,1);
		}
	}
	var successPercent = audiogame.successCount / 5;
	successPercent=Math.max(0,Math.min(1,successPercent));
	audiogame.melody.volume=successPercent;
		
	// move the dots
	for(var i in audiogame.dots){
		audiogame.dots[i].distance -= 10;
	}

	// only clear the dirty area, that is the middle area
	ctx.clearRect(0,0,ctx.canvas.width, ctx.canvas.height);
				
	// draw the music note dots
	for(var i in audiogame.dots){
		// prepare the radial gradients fill style		
		/*var circle_gradient = ctx.createRadialGradient(-3,-3,1,0,0,20);
		circle_gradient.addColorStop(0, "#fff");
		circle_gradient.addColorStop(1, "#cc0");
		ctx.fillStyle = circle_gradient;*/
		
		// draw the path
		ctx.save();	
		var center = game.width/2;
		var dot = audiogame.dots[i];
		var x = center-330				
		if (dot.line == 2)	{			
			x = center-198;
		}
		else if (dot.line == 3)	{		
			x = center-66;
		}
		else if (dot.line == 4)	{		
			x = center+66;
		}
		else if (dot.line == 5)	{		
			x = center+198;
		}
		else if (dot.line == 6)	{		
			x = center+330;
		}
		ctx.translate(x, ctx.canvas.height-120-audiogame.dots[i].distance);
		ctx.drawImage(audiogame.dotImage, -audiogame.dotImage.width/2, -audiogame.dotImage.height/2);	//畫距離，每次都將Y軸-距離	
		ctx.restore();
	}
	
	if (boolen1==true){

		c1=c1+1;
		flotime1=c1/100
		t1=setTimeout("",1);
	}
	if (boolen1==false){
			c1=0;
			//$("#output1").html("Time:"+flotime1);
	}
	
	
	if (boolen2==true){
		//$("#output2").html("Time:"+flotime2);
		c2=c2+1;
		flotime2=c2/100
		t2=setTimeout("",1);
	}
	if (boolen2==false){
			c2=0;
			//$("#output2").html("Time:"+flotime2);
	}
	
	if (boolen3==true){
		//$("#output3").html("Time:"+flotime3);
		c3=c3+1;
		flotime3=c3/100
		t3=setTimeout("",1);
	}
	if (boolen3==false){
			c3=0;
			//$("#output3").html("Time:"+flotime3);
	}
	
	if (boolen4==true){
		//$("#output4").html("Time:"+flotime4);
		c4=c4+1;
		flotime4=c4/100
		t4=setTimeout("",1);
	}
	if (boolen4==false){
			c4=0;
			//$("#output4").html("Time:"+flotime4);
	}
	if (boolen5==true){
		//$("#output5").html("Time:"+flotime5);
		c5=c5+1;
		flotime5=c5/100
		t5=setTimeout("",1);
	}
	if (boolen5==false){
			c5=0;
			//$("#output5").html("Time:"+flotime5);
	}
	if (boolen6==true){
		//$("#output6").html("Time:"+flotime6);
		c6=c6+1;
		flotime6=c6/100
		t6=setTimeout("",1);
	}
	if (boolen6==false){
			c6=0;
			//$("#output6").html("Time:"+flotime6);
	}
}
function onGameEnded(){
					
	totalscore=great*100+perfect*150;		
	var greatstr=great.toString();
	var perfectstr=perfect.toString();
	var missstr=miss.toString();
	var scorestr=totalscore+toString();
	if(great<100){
		greatstr="0"+greatstr;
		if(great<10){
			greatstr="0"+greatstr;
		}
	}
	if(perfect<100){
		perfectstr="0"+perfectstr;
		if(perfect<10){
			perfectstr="0"+perfectstr;
		}
	}

	if(miss<100){
		missstr="0"+missstr;
		if(miss<10){
			missstr="0"+missstr;
		}
	}

	$("#great1").addClass('n'+greatstr.charAt(0));
	$("#great2").addClass('n'+greatstr.charAt(1));
	$("#great3").addClass('n'+greatstr.charAt(2));
	$("#perfect1").addClass('n'+perfectstr.charAt(0));
	$("#perfect2").addClass('n'+perfectstr.charAt(1));
	$("#perfect3").addClass('n'+perfectstr.charAt(2));
	$("#miss1").addClass('n'+missstr.charAt(0));
	$("#miss2").addClass('n'+missstr.charAt(1));
	$("#miss3").addClass('n'+missstr.charAt(2));
	$("#score1").addClass('n'+scorestr.charAt(0));
	$("#score2").addClass('n'+scorestr.charAt(1));
	$("#score3").addClass('n'+scorestr.charAt(2));
	$("#score4").addClass('n'+scorestr.charAt(3));
	$("#score5").addClass('n'+scorestr.charAt(4));
	$("#score6").addClass('n'+scorestr.charAt(5));
	
	$("#final-scene").addClass('show-scene');
	console.log('song ended');
	console.log('totalscore='+totalscore);
	console.log('success precent:',audiogame.totalSuccessCount / audiogame.totalDotsCount *100+'%');

}